# ====================================================================
# Tmux Configuration
# ====================================================================
# Author: Dennis Bakhuis
# Date: 2025-10-12
#
# Key Bindings Quick Reference:
# ------------------------------
# Prefix: Ctrl-b (default)
#
# Windows (tabs):
#   c           - Create new window
#   ,           - Rename current window
#   n/p         - Next/Previous window
#   0-9         - Switch to window by number
#   Ctrl-h/l    - Previous/Next window (repeatable)
#   &           - Kill current window
#
# Panes (splits):
#   |           - Split horizontally (left/right)
#   -           - Split vertically (top/bottom)
#   h/j/k/l     - Navigate panes (vim-style)
#   H/J/K/L     - Resize panes (repeatable)
#   x           - Kill current pane
#   z           - Zoom/unzoom current pane
#   space       - Cycle through layouts
#
# Copy mode (vi-style):
#   [           - Enter copy mode
#   v           - Start selection
#   y           - Copy selection (uses isomorphic_copy/pbcopy)
#   q           - Exit copy mode
#   Mouse drag  - Select text
#   Mouse click - Copy selection (after drag, click in selected area)
#
# Other:
#   r           - Reload tmux config
#   ?           - Show all key bindings
# ====================================================================

# Plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'

set-option -g history-limit 25000
set -g mouse on

# for neovim
set -sg escape-time 10
setw -g xterm-keys on
set -g allow-passthrough on

# vi for copy mode
setw -g mode-keys vi

# Vi-style copy mode bindings
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"

# Isomorphic copy integration for mouse selection
# Drag to select, click in selected area to copy (works with isomorphic_copy)
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X stop-selection
bind-key -T copy-mode-vi MouseDown1Pane select-pane \; send-keys -X copy-pipe "c" \; send-keys -X clear-selection

# status bar
set -g status-position top
set -g status-interval 1
set -g status-bg default
set -g status-fg "#928374"

# Left side: session name
set -g status-left "#[fg=#7aa2f7,bold] #S #[default] "
set -g status-left-length 50

# Center: window list (this shows all your windows/tabs)
set -g status-justify centre
set -g window-status-format "#[fg=#565f89] #I:#W "
set -g window-status-current-format "#[fg=#7aa2f7,bold] #I:#W "
set -g window-status-separator ""

# Right side: time and optional pomo
set -g status-right "#(pomo) #[fg=#928374] %H:%M "
set -g status-right-length 50

# count the panes from 1
set -g base-index 1
setw -g pane-base-index 1

# reload configuration
bind-key r source-file ~/.tmux.conf \; display-message "~/.tmux.conf reloaded"

# unbind ctrl enter
unbind C-Enter

# True color settings
set -g default-terminal "$TERM"
set -ag terminal-overrides ",$TERM:Tc"

# Switch panes with hjkl (vim-style)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Resize panes with HJKL (hold prefix)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Better window splitting (more intuitive)
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

# Easy window navigation
bind -r C-h select-window -t :-
bind -r C-l select-window -t :+

# Quick window switching with number keys (no prefix needed after first press)
bind -r 0 select-window -t :0
bind -r 1 select-window -t :1
bind -r 2 select-window -t :2
bind -r 3 select-window -t :3
bind -r 4 select-window -t :4
bind -r 5 select-window -t :5
bind -r 6 select-window -t :6
bind -r 7 select-window -t :7
bind -r 8 select-window -t :8
bind -r 9 select-window -t :9

set-option -g focus-events on
set-option -g set-clipboard on

# only show status bar if there is more then one window
set -g status off
set-hook -g after-new-window      'if "[ #{session_windows} -gt 1 ]" "set status on"'
set-hook -g after-kill-pane       'if "[ #{session_windows} -lt 2 ]" "set status off"'
set-hook -g pane-exited           'if "[ #{session_windows} -lt 2 ]" "set status off"'
set-hook -g window-layout-changed 'if "[ #{session_windows} -lt 2 ]" "set status off"'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

